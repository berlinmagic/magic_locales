<%= magic_locaoles_admin_template do %>

  <%= content_for :headline do %>
    
    <%= link_to "+ #{t("activerecord.attributes.magic_locales_locale.one")}", url_for( controller: "magic_locales/locales", action: :new), class: "btn btn-success pull-right btn-sm", data: { toggle: "modal", target: "#appModal" } %> 
    <i class="icon-bubbles"></i> <%= t("activerecord.attributes.magic_locales_locale.other") %>
    
  <% end %>


  <h4>
    <strong><%= t("magic_locales.available_locales") %></strong> 
    <% I18n.available_locales.each do |lang| %>
      <%= locale_flag( "#{lang}", "small" ) %>
    <% end %>
  </h4>
  <div class="clearfix"></div>
  <table class="table table-condensed">
    <% %w(live active inactive).each do |this| %>
      <tr>
        <th><%= t("helpers.label.magic_locales_locale.states.#{this}") %></th>
        <td><%= t("magic_locales.state_descriptions.#{this}") %></td>
      </tr>
    <% end %>
    <tr>
      <th><%= t("magic_locales.available") %>*</th>
      <td><%= t("magic_locales.available_locales_helper") %></td>
    </tr>
  </table>
  <hr/>
  <table class="table table-striped">
    <thead>
      <tr>
        
        <th><%= t("helpers.label.magic_locales_locale.iso_code") %></th>
        <th><%= t("helpers.label.magic_locales_locale.name") %></th>
        <th><%= t("helpers.label.magic_locales_locale.locale_state") %></th>
        <th><%= t("magic_locales.available") %></th>
        <th><%= t("magic_locales.trigger") %></th>
        <th><%= t("magic_locales.actions") %></th>
        
      </tr>
    </thead>
    <tbody>
    <% @locales.each do |locale| %>
      <% if locale.locale_state == "live" && I18n.available_locales.include?(locale.iso_code.to_sym) %>
        <% trclass = "success" %>
      <% elsif locale.locale_state == "active" && I18n.available_locales.include?(locale.iso_code.to_sym) %>
        <% trclass = "info" %>
      <% elsif locale.locale_state == "inactive" && I18n.available_locales.include?(locale.iso_code.to_sym) %>
        <% trclass = "warning" %>
      <% elsif (locale.locale_state == "active" || locale.locale_state == "live") && !I18n.available_locales.include?(locale.iso_code.to_sym) %>
        <% trclass = "danger" %>
      <% else %>
        <% trclass = "" %>
      <% end %>
      <tr class="<%= trclass %>">
        <td>
          <%= locale_flag( locale.iso_code, "small" ) %>
          <%= locale.iso_code %>
        </td>
        <td><strong><%= locale.name %></strong></td>
        <td>
          <%= t("helpers.label.magic_locales_locale.states.#{locale.locale_state}") %>
          <% if I18n.default_locale.to_s == locale.iso_code %>
            &nbsp;&nbsp; 
            <span class="label label-success"><%= t("magic_locales.main_locale") %></span>
          <% end %>
          <% if I18n.locale.to_s == locale.iso_code %>
            &nbsp;&nbsp; 
            <span class="label label-success"><%= t("magic_locales.active_locale") %></span>
          <% end %>
        </td>
        <td>
          <% if I18n.available_locales.include?(locale.iso_code.to_sym) %>
            <span class="text-success"><%= t("magic_locales.availables.true") %></span>
          <% else %>
            <span class="text-danger"><%= t("magic_locales.availables.false") %></span>
          <% end %>
        </td>
        <td>
          <% %w(activate release deactivate).each do |state| %>
            <% if locale.state.trigger?(state.to_sym) %>
              <%= link_to t("magic_locales.triggers.#{state}"), url_for( controller: "magic_locales/locales", action: :trigger, id: locale, state: state), class: "btn btn-default btn-sm" %>
            <% end %>
          <% end %>
        </td>
        <td>
          <%= link_to t("magic_locales.edit"), url_for( controller: "magic_locales/locales", action: :edit, id: locale), class: "btn btn-default btn-sm", data: { toggle: "modal", target: "#appModal" } %>
        </td>
      </tr>
    <% end %>
    </tbody>
  </table>

<% end %>
